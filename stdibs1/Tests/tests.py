from selenium import webdriver
from time import sleep
import unittest
from selenium.webdriver import ActionChains
import HtmlTestRunner


from stdibs1.Pages.loginPage import LoginPage
from stdibs1.Pages.mainMenu import Main_Menu
from stdibs1.Pages.productPage import Product_Page
from stdibs1.Pages.bottomMenu import BottomMenu
from stdibs1.Pages.purchaseProduct import PP
from stdibs1.Pages.myCart import MyCart


class MenuTest1(unittest.TestCase):

    @classmethod
    def setUpClass(cls):
        # driver = webdriver.Chrome(executable_path= '../drivers/chromedriver.exe')
        cls.driver = webdriver.Chrome(executable_path='C:/Users/mumtaz/Desktop/python/drivers/chromedriver1.exe')
        # cls.driver = webdriver.Chrome(executable_path='..\..\drivers\chromedriver1.exe')
        cls.driver.get("https://www.1stdibs.com/")
        cls.driver.implicitly_wait(1)
        # cls.driver.find_element_by_xpath("//div[@id='adroll_reject']").click()
        # cls.driver.find_element_by_xpath("//a[contains(text(),'Allow')]").click()
        cls.driver.maximize_window()

# ----------------------------------------------------------------------------------------------------------------------
# this test click on Log In link and accept popups after log in
# ----------------------------------------------------------------------------------------------------------------------
    def test_a_login(self):
        driver = self.driver
        loginPage = LoginPage(driver)
        loginPage.login_link_click()

        sleep(2)
        loginPage.enter_user_email("virgo4m@gmail.com")
        loginPage.enter_user_password("vici2FHh")
        sleep(1)
        loginPage.click_login_btn()
        sleep(2)
        # loginPage.chkbox()
        # loginPage.continue_btn()
        loginPage.click_welcome_window()
        # sleep(2)

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_a_login(self)
# ----------------------------------------------------------------------------------------------------------------------


# ----------------------------------------------------------------------------------------------------------------------
    # this test covers TOP RIGHT MENU
    # My Account--> Notification --> My Cart etc
# ----------------------------------------------------------------------------------------------------------------------
    def test_b_topRightMenu(self):
        driver = self.driver
        topRightMenu = LoginPage(driver)
        topRightMenu.topright_menu1()
# ----------------------------------------------------------------------------------------------------------------------
#     END  test_b_topRightMenu(self)_
# ----------------------------------------------------------------------------------------------------------------------


# ----------------------------------------------------------------------------------------------------------------------
# this test covers MAIN MENU
# --> FURNITURE --> ART  --> JEWELRY & WATCHES --> FASHION --> INTERIORS --> NEWS & CUSTOM --> STYLES --> SALES
# ----------------------------------------------------------------------------------------------------------------------
    def test_c_mainMenu(self):
        driver = self.driver
        mainMenu = Main_Menu(driver)
        mainMenu.main_menu()
# ----------------------------------------------------------------------------------------------------------------------
#     END  test_c_mainMenu(self)
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test checks on BOTTOM MENUS
# ----------------------------------------------------------------------------------------------------------------------
    def test_d_bottom_menu(self):
        driver = self.driver
        bottom_menu = BottomMenu(driver)
        bottom_menu.bottom_menu()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_u_bottom_menu(self):
# ----------------------------------------------------------------------------------------------------------------------



# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "Furniture" and checks submenu links
# also click randomly a submenu in Furniture's main menu and move to next product page
# ----------------------------------------------------------------------------------------------------------------------
    def test_e_furniture_menu(self):
        driver = self.driver
        furniture_menu = Main_Menu(driver)
        furniture_menu.furniture_subMenu()
# ----------------------------------------------------------------------------------------------------------------------
#     END  test_e_furniture_menu(self)
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test randomly select a product and click on that product--> move to next page
# ----------------------------------------------------------------------------------------------------------------------
    def test_f_select_product(self):
        driver = self.driver
        select_product = Product_Page(driver)
        select_product.click_Product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_f_select_product(self)
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test put product in shopping cart
# ----------------------------------------------------------------------------------------------------------------------
    def test_g_purchase_product(self):
        driver = self.driver
        click_on = PP(driver)
        click_on.purchase_product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_g_select_product(self)
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "Art" and checks submenu links
# also click randomly a submenu in Art's main menu and move to next product page
# ----------------------------------------------------------------------------------------------------------------------
    def test_h_art_menu(self):
        driver = self.driver
        art_menu = Main_Menu(driver)
        art_menu.art_subMenu()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_h_art_menu(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test randomly select a product and click on that product--> move to next page
# ----------------------------------------------------------------------------------------------------------------------
    def test_i_select_product(self):
        driver = self.driver
        select_product = Product_Page(driver)
        select_product.click_Product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_i_select_product(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test put product in shopping cart
# ----------------------------------------------------------------------------------------------------------------------
    def test_j_purchase_product(self):
        driver = self.driver
        click_on = PP(driver)
        click_on.purchase_product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_j_purchase_product(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "Jewelry & Watches" and checks submenu links
# ----------------------------------------------------------------------------------------------------------------------
    def test_k_jw_menu(self):
        driver = self.driver
        jw_menu = Main_Menu(driver)
        jw_menu.jw_subMenu()
# ----------------------------------------------------------------------------------------------------------------------
#     END  test_k_art_menu(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test randomly select a product and click on that product--> move to next page
# ----------------------------------------------------------------------------------------------------------------------
    def test_l_select_product(self):
        driver = self.driver
        select_product = Product_Page(driver)
        select_product.click_Product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_l_select_product(self)
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test put product in shopping cart
# ----------------------------------------------------------------------------------------------------------------------
    def test_m_purchase_product(self):
        driver = self.driver
        click_on = PP(driver)
        click_on.purchase_product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_m_select_product(self)
# ----------------------------------------------------------------------------------------------------------------------


# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "FASHION" and checks submenu links
# ----------------------------------------------------------------------------------------------------------------------
    def test_n_fashion_menu(self):
        driver = self.driver
        fashion_menu = Main_Menu(driver)
        fashion_menu.fashion_subMenu()
# ----------------------------------------------------------------------------------------------------------------------
#     END  test_n_fashion_menu(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test randomly select a product and click on that product--> move to next page
# ----------------------------------------------------------------------------------------------------------------------
    def test_o_select_product(self):
        driver = self.driver
        select_product = Product_Page(driver)
        select_product.click_Product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_o_select_product(self)
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test put product in shopping cart
# ----------------------------------------------------------------------------------------------------------------------
    def test_p_purchase_product(self):
        driver = self.driver
        click_on = PP(driver)
        click_on.purchase_product()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_p_select_product(self)
# ----------------------------------------------------------------------------------------------------------------------



# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "INTERIORS" and checks submenu links
# ----------------------------------------------------------------------------------------------------------------------
    def test_q_interiors_menu(self):
        driver = self.driver
        interiors_menu = Main_Menu(driver)
        interiors_menu.interiors_subMenu()
# ----------------------------------------------------------------------------------------------------------------------
#     END  test_q_interiors_menu(self)::
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "NEW & CUSTOM" and checks submenu links
# ----------------------------------------------------------------------------------------------------------------------
    def test_r_nc_menu(self):
        driver = self.driver
        nc_menu = Main_Menu(driver)
        nc_menu.nc_subMenu()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_r_nc_menu(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "NEW & CUSTOM" and checks submenu links
# ----------------------------------------------------------------------------------------------------------------------
    def test_s_style_menu(self):
        driver = self.driver
        style_menu = Main_Menu(driver)
        style_menu.style_subMenu()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_s_style_menu(self):
# ----------------------------------------------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------------------------------------------
# this test click on MAIN MENU "NEW & CUSTOM" and checks submenu links
# ----------------------------------------------------------------------------------------------------------------------
    def test_t_sale_menu(self):
        driver = self.driver
        sale_menu = Main_Menu(driver)
        sale_menu.sale_subMenu()

# ----------------------------------------------------------------------------------------------------------------------
#     END  test_t_style_menu(self):
# ----------------------------------------------------------------------------------------------------------------------
#


# ----------------------------------------------------------------------------------------------------------------------
# this test click on PURCHASE PRODUCTS
# ----------------------------------------------------------------------------------------------------------------------
    def test_u_myCart(self):
        driver = self.driver
        view_product = MyCart(driver)
        # view_product.del_cart_product()
        view_product.purchase_product()
        sleep(2)

# ----------------------------------------------------------------------------------------------------------------------
#     END test_w_myCart(self):
# ----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------
# STARTING BOTTOM MENU
# -----------------------------------------------------------------------



    sleep(3)

# ----------------------------------------------------------------------------------------------------------------------
# this test covers TOP RIGHT "My Account" MENU
# My Account--> Account Information
#           --> My Order
#           --> My Conversations
#           --> Logout
# ----------------------------------------------------------------------------------------------------------------------
    def test_w_myAccountMenu(self):
        driver = self.driver
        # sleep(2)
        myAccountMenu = LoginPage(driver)
        myAccountMenu.myAccount_menu()
# ----------------------------------------------------------------------------------------------------------------------
#     END test_z_myAccountMenu(self)
# ----------------------------------------------------------------------------------------------------------------------


    @classmethod
    def tearDownClass(cls):
        cls.driver.close()
        cls.driver.quit()



if __name__ == '__main__':
    # unittest.main()
    unittest.main(testRunner=HtmlTestRunner.HTMLTestRunner(output='C:\\Users\\mumtaz\\Desktop\\python\\stdibs1\\Reports'))
